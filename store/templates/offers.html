{% extends 'base.html' %}


{% block content %}
{% load cart %}
{% load custom_filter %}

<style>

</style>

<link rel="stylesheet" href="https://demos.creative-tim.com/notus-js/assets/styles/tailwind.css">

<div class="w-full sm:mx-4 md:w-6/12 md:mx-auto">
      <div class="flex justify-center">
          <div class="w-full">

            <h2 class="text-2xl mb-2">Vos offres</h2>
            <table class="table w-full border-collapse">
                <tbody>
                      {% for product in products %}
                      <tr class="border-t border-gray-200">
                          <td>
                              <div class="card rounded-3 mb-2">
                                <a href="{% url 'product' product.0.id %}">
                                  <div class="card-body p-2">
                                      <div class="flex justify-between items-center h-full" style="padding-left: 0.5rem;">
                                          <div class="h-48 w-32">
                                              <img src="{{ product.0.id|get_first_image_product }}" class="object-cover" alt="">
                                          </div>
                                          <div class="flex-shrink-0 w-4/12">
                                              <p class="text-lg font-normal mb-2"><a href="/product/{{ product.0.id }}">{{ product.0.name }}</a></p>
                                              <p><span class="text-muted"><a href="/product/{{ product.0.id }}">{{ product.0.category }}</a></span></p>
                                          </div>
                                          <div class="flex-shrink-0 w-3/12">
                                              <h5 class="mb-0">{{ product.0.price|currency }}</h5>
                                          </div>
                                      </div>
                                  </div>
                                </a>
                              </div>
                          </td>
                          <td>
                              {% if product.2 > 0 %}
                              <div>
                                  <h5 class="mb-0">Nombre d'offres: {{ product.2 }}</h5>
                                  <div class="mt-2 text-center">
                                      <h5>{{product.1.price|currency}}</h5>
                                      <form action="/check-out" method="POST">
                                          {% csrf_token %}
                                          <input hidden type="text" name='offer' value='{{product.1.id}}'>
                                          <input type="submit" value="Accepter" class="btn accept">
                                      </form>
                                      <form action="/offers" method="POST" class="mt-2">
                                          {% csrf_token %}
                                          <input hidden type="text" name='offer' value='{{product.1.id}}'>
                                          <input type="submit" value="Refuser" class="btn refuse">
                                      </form>
                                  </div>
                              </div>
                              {% else %}
                              <span class="no_offer">Vous n'avez pas d'offre pour ce produit</span>
                              {% endif %}
                          </td>
                      </tr>
                      {% endfor %}
                  </tbody>
              </table>
          </div>
  </div>
</div>


{% comment %} 
  <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">
              Processus d'achat
          </h5>
          <hr>
          <span>
            Le processus d'achat est assez simplifier, s'agisant d'un projet étudiant nous n'avons pas pu mettre en place un système de paiement sécurisé. De se fait vous devrez vous mettre en accord avec l'acheteur par message pour proceder aau paiment, aussi cela nous permet de ne pas prendre de commission sur vos ventes et de rester 100% gratuit.<br>
            En ce qui concerne la méthode livraison des différents syllabus, nous avons un local dans le quelle vous pouvez deposer le syllabus, ou sinon vous pouvez vous arranger avec le vendeur par message.<br>
            Merci de votre compréhension et de votre soutient à ce projet.
          </span>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="m-2 p-3">
            <form action="/check-out" method="POST">
                {% csrf_token %}
                <input type="submit" class="btn float-right btn-outline-success col-lg-6" value="Acheter">
            </form>
          </div>
        </div>
        
      </div>
    </div>
  </div> {% endcomment %}


{% endblock %}